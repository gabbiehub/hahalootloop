{% load static %}
<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta charset="utf-8" />
    <link rel="stylesheet" href="{% static 'css/globals.css' %}" />
    <link rel="stylesheet" href="{% static 'css/profile/profile.css' %}" />
    <style>
      .bio-modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        justify-content: center;
        align-items: center;
        z-index: 1000;
      }
      .bio-modal-content {
        background: white;
        padding: 20px;
        border-radius: 8px;
        width: 400px;
        max-width: 90%;
        position: relative;
      }
      .bio-modal-content textarea {
        width: 100%;
        height: 100px;
        margin-bottom: 10px;
        padding: 8px;
        font-size: 16px;
      }
      .bio-modal-content button {
        padding: 8px 16px;
        margin-right: 10px;
        cursor: pointer;
      }
      .close-bio-modal {
        position: absolute;
        top: 10px;
        right: 10px;
        cursor: pointer;
      }
    </style>
  </head>
  <body>
    {% csrf_token %}
    <div class="user-profile-page">
      <!-- Sidebar -->
      <div class="sidebar">
        <div class="sidebar-home">
          <a href="{% url 'homepage' %}">
            <img class="home-icon" src="{% static 'img/homepage/Home.png' %}" alt="Home Icon" />
          </a>
        </div>
        <button class="chat-button" id="chatButton" aria-label="Open chat">
          <img class="chat-icon" src="{% static 'img/homepage/chat room.png' %}" alt="Chat Icon" />
        </button>
        <img class="settings-icon" src="{% static 'img/homepage/Settings.png' %}" alt="Settings Icon" />
        <img class="notifications-icon" src="{% static 'img/homepage/Notif.png' %}" alt="Notifications Icon" />
        <div class="sidebar-profile">
          <a href="{% url 'profile' %}">
            <img class="user-profile" src="{% if user_profile and user_profile.profile_picture %}{{ user_profile.profile_picture.url }}{% else %}{% static 'img/homepage/Profile.png' %}{% endif %}" alt="User Profile" />
          </a>
        </div>
      </div>

      <!-- Message Modal -->
      <div class="modal" id="messageModal">
        <div class="modal-content message">
          <img class="close-window" src="{% static 'img/close-window.png' %}" alt="Close" id="closeMessageModal" />
          <div class="text-wrapper">Chat</div>
          <div class="sidebar">
            <div class="search-bar">
              <input type="text" placeholder="Search..." style="width: 100%; height: 100%; padding: 0.5rem;">
            </div>
            <div class="div">Recent Conversations</div>
            <div class="chat-list">
              <div class="chat-item active">
                <img class="chat-pfp" src="{% static 'img/homepage modals/pfp 1.png' %}" alt="Profile picture" />
                <div class="chat-info">
                  <div class="chat-name">KatsuraDa</div>
                  <div class="chat-preview">Yes, nabili ko sila dun mismo sa...</div>
                </div>
                <div class="chat-time">8:57 pm</div>
              </div>
              <!-- ... other chat items ... -->
            </div>
          </div>
          <div class="chat-area">
            <div class="sino-kausap">
              <div class="overlap-6">
                <img class="pfp-3" src="{% static 'img/homepage modals/pfp 2.png' %}" alt="Profile" />
                <div class="text-wrapper-6">KatsuraDa</div>
                <div class="text-wrapper-12">@zurajanai</div>
                <div class="group-10">
                  <div class="overlap-14">
                    <div class="text-wrapper-13">View profile</div>
                  </div>
                </div>
              </div>
            </div>
            <div class="message-opssen">
              <div class="chat-bubble other-user">
                <p class="hey-i-saw-your-2">
                  Hey! I saw your collection. Ganda ng figurines mo ah. Matagal ka na nagko-collect?
                </p>
                <span class="message-time">06:00 PM</span>
              </div>
              <!-- ... other messages ... -->
            </div>
            <div class="overlap-15">
              <div class="overlap-16">
                <input type="text" class="text-wrapper-14" placeholder="Write your message" />
                <img class="attach" src="{% static 'img/homepage modals/attach.png' %}" alt="Attach" />
                <img class="send-icon" src="{% static 'img/homepage modals/send.png' %}" alt="Send" />
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Bio Edit Modal -->
      <div class="bio-modal" id="bioModal">
        <div class="bio-modal-content">
          <img class="close-bio-modal" src="{% static 'img/close-window.png' %}" alt="Close" id="closeBioModal" />
          <h2>Edit Bio</h2>
          <textarea id="bioInput" placeholder="Enter your bio"></textarea>
          <button id="saveBioButton">Save</button>
          <button id="cancelBioButton">Cancel</button>
        </div>
      </div>

      <img class="logo" src="{% static 'img/logo 2.png' %}" alt="Logo" />
      <div class="overlap">
        <div class="overlap-group">
          <img class="image" src="{% static 'img/profile/banner.png' %}" />
          <div class="box nav-box">
            <div class="nav">
              <div class="overlap-group">
                <div class="rectangle"></div>
                <div class="text-wrapper">Home</div>
              </div>
              <div class="div">Wishlist</div>
              <div class="text-wrapper-2">History</div>
              <div class="text-wrapper-3">Collections</div>
            </div>
          </div>
          <div class="prof-info">
            <div class="box">
              <div class="text-wrapper bio-text" id="bioText" style="cursor: pointer;">
                {% if user_profile %}
                  {{ user_profile.bio|default:"Add a bio to tell others about yourself!" }}
                {% else %}
                  Add a bio to tell others about yourself!
                {% endif %}
              </div>
              <div class="group">
                <div class="overlap">
                  <div class="following">
                    <div class="overlap-group">
                      <div class="div">{{ following_count }}</div>
                      <div class="text-wrapper-2">Following</div>
                    </div>
                  </div>
                  <div class="followers">
                    <div class="overlap-2">
                      <div class="div">{{ followers_count }}</div>
                      <div class="text-wrapper-3">Followers</div>
                    </div>
                  </div>
                  <div class="trades">
                    <div class="overlap-3">
                      <div class="text-wrapper-4">{{ trades_count }}</div>
                      <div class="overlap-group-wrapper">
                        <div class="overlap-group-2">
                          <div class="text-wrapper-5">Trades</div>
                          <img class="eva-question-mark" src="{% static 'img/profile/more info.png' %}" />
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <img class="majesticons-share" src="{% static 'img/profile/share.png' %}" />
              <div class="overlap-4">
                <div class="group-2">
                  <div class="div-wrapper">
                    <div class="overlap-group-3">
                      <div class="rectangle"></div>
                      <div class="text-wrapper-6">Edit profile</div>
                    </div>
                  </div>
                  <div class="overlap-wrapper">
                    <div class="overlap-5">
                      <div class="text-wrapper-7">Sign out</div>
                    </div>
                  </div>
                </div>
                <img class="mi-edit" src="{% static 'img/profile/edit.png' %}" />
                <button class="signout-button" onclick="window.location.href='/'">
                  <img class="uil-signout" src="{% static 'img/profile/signout.png' %}" alt="Sign Out" />
                </button>
              </div>
              <div class="overlap-6">
                <div class="text-wrapper-8">{{ user.username }}</div>
                <div class="text-wrapper-9">@{{ user.username|lower }}</div>
              </div>
              <img class="line" src="{% static 'img/profile/line.png' %}" />
              <img class="img" src="{% static 'img/profile/line.png' %}" />
              <img class="a" src="{% if user_profile and user_profile.profile_picture %}{{ user_profile.profile_picture.url }}{% else %}{% static 'img/profile/profile big.png' %}{% endif %}" />
            </div>
          </div>
        </div>
        <div class="frame">
          <div class="fb">
            <p>Found {{ items.count }} items</p>
            {% for item in items %}
            <div class="post">
              <div class="overlap-7">
                <div class="overlap-8">
                  <div class="text-wrapper-11">{{ user.username }}</div>
                  <div class="text-wrapper-12">{{ item.created_at|date:"j F \a\t H:i" }}</div>
                  <img class="a-2" src="{% if user_profile and user_profile.profile_picture %}{{ user_profile.profile_picture.url }}{% else %}{% static 'img/profile/profile small.png' %}{% endif %}" />
                </div>
                <p class="p">{{ item.description|truncatewords:50 }}</p>
                {% if item.image %}
                <div class="group-3">
                  <div class="overlap-group-5">
                    <img class="image-2" src="{{ item.image.url }}" />
                  </div>
                </div>
                {% endif %}
                <div class="group-4">
                  <div class="text-wrapper-13">0</div>
                  <div class="text-wrapper-14">0</div>
                  <div class="text-wrapper-15">0</div>
                  <img class="facebook-like" src="{% static 'img/profile/like.png' %}" />
                  <img class="facebook-like-2" src="{% static 'img/profile/dislike.png' %}" />
                  <img class="mdi-comment" src="{% static 'img/profile/comment.png' %}" />
                </div>
                <img class="oi-ellipses" src="{% static 'img/profile/menu.png' %}" />
              </div>
            </div>
            <img class="line-2" src="{% static 'img/profile/line.png' %}" />
            {% empty %}
            <div class="group-8">
              <div class="overlap-10">
                <div class="text-wrapper-18">No posts yet. Share your first item!</div>
                <img class="line-3" src="{% static 'img/profile/line.png' %}" />
                <img class="line-4" src="{% static 'img/profile/line.png' %}" />
              </div>
            </div>
            {% endfor %}
            <div class="frame-2">
              <div class="highlights">
                {% for item in items|slice:":4" %}
                {% if item.image %}
                <img class="image-4" src="{{ item.image.url }}" />
                {% endif %}
                {% empty %}
                <div class="text-wrapper-16">No highlights available.</div>
                {% endfor %}
              </div>
              <div class="text-wrapper-16">Highlights</div>
            </div>
            <div class="group-5">
              <div class="overlap-9">
                <div class="rectangle-2"></div>
                <div class="rectangle-3"></div>
                <div class="group-6">
                  <img class="vector" src="{% static 'img/profile/attachment.png' %}" />
                  <img class="group-7" src="{% static 'img/profile/photo.png' %}" />
                  <img class="vector-2" src="{% static 'img/profile/video.png' %}" />
                </div>
                <img class="a-3" src="{% if user_profile and user_profile.profile_picture %}{{ user_profile.profile_picture.url }}{% else %}{% static 'img/profile/profile small.png' %}{% endif %}" />
                <div class="rectangle-4"></div>
                <p class="text-wrapper-17">What’s new in your collection, {{ user.username }}?</p>
              </div>
            </div>
          </div>
        </div>

        <div class="wishes" id="wishlistFrame" style="display: none;">
          <div class="wish-group">
            <p class="text-wrapper-26">Wishlist functionality coming soon!</p>
          </div>
        </div>

        <!-- Latest Updates and Suggestions (static for now) -->
        <div class="latest-updates">
          <div class="overlap-12">
            <div class="overlap-13">
              <div class="text-wrapper-23">Latest updates</div>
              <div class="overlap-14">
                <div class="bluey">
                  <div class="overlap-group-6">
                    <p class="text-wrapper-24">akosiblueyyy shared a post:<br />"Fate/Stay Night collectors...</p>
                    <div class="text-wrapper-25">1 hour ago</div>
                  </div>
                  <img class="img-2" src="{% static 'img/homepage modals/pfp 6.png' %}" />
                </div>
                <div class="katsu">
                  <div class="overlap-15">
                    <p class="text-wrapper-24">KatsuraDa posted an update:<br />"Finally got my hands on th...”</p>
                    <div class="text-wrapper-25">Just Now</div>
                  </div>
                  <img class="img-2" src="{% static 'img/homepage modals/pfp 2.png' %}" />
                </div>
                <img class="line-6" src="{% static 'img/profile/line.png' %}" />
              </div>
            </div>
            <div class="dory">
              <div class="text-wrapper-26">findingdory posted an update.</div>
              <div class="text-wrapper-27">1 hour ago</div>
              <img class="img-2" src="{% static 'img/homepage modals/pfp 3.png' %}" />
            </div>
            <div class="cora">
              <div class="text-wrapper-28">Coraline posted an update.</div>
              <div class="text-wrapper-29">4 hours ago</div>
              <img class="pfp" src="{% static 'img/homepage modals/pfp 5.png' %}" />
            </div>
          </div>
        </div>
        <div class="suggestions">
          <div class="overlap-12">
            <div class="overlap-16">
              <div class="text-wrapper-30">Suggestions</div>
              <div class="asunta">
                <div class="text-wrapper-31">Asunta de Rousey</div>
                <div class="group-9">
                  <div class="follow">
                    <div class="overlap-group-3">
                      <div class="rectangle-6"></div>
                      <div class="text-wrapper-32">Follow</div>
                    </div>
                  </div>
                  <div class="remove">
                    <div class="overlap-17"><div class="text-wrapper-33">Remove</div></div>
                  </div>
                </div>
                <img class="img-2" src="{% static 'img/homepage modals/pfp 1.png' %}" />
              </div>
              <div class="ruleth">
                <div class="text-wrapper-34">areyouleth</div>
                <div class="group-10">
                  <div class="follow">
                    <div class="overlap-group-3">
                      <div class="rectangle-6"></div>
                      <div class="text-wrapper-32">Follow</div>
                    </div>
                  </div>
                  <div class="remove">
                    <div class="overlap-17"><div class="text-wrapper-33">Remove</div></div>
                  </div>
                </div>
                <img class="img-2" src="{% static 'img/homepage modals/pfp 4.png' %}" />
              </div>
              <img class="line-7" src="{% static 'img/profile/line.png' %}" />
            </div>
            <div class="pat">
              <div class="text-wrapper-35">TheIronPat</div>
              <div class="group-11">
                <div class="follow">
                  <div class="overlap-group-3">
                    <div class="rectangle-6"></div>
                    <div class="text-wrapper-32">Follow</div>
                  </div>
                </div>
                <div class="remove">
                  <div class="overlap-17"><div class="text-wrapper-33">Remove</div></div>
                </div>
              </div>
              <img class="img-2" src="{% static 'img/homepage modals/pfp 2.png' %}" />
            </div>
            <div class="dha">
              <div class="text-wrapper-36">AMDHASiRUSWAN?</div>
              <div class="group-12">
                <div class="follow">
                  <div class="overlap-group-3">
                    <div class="rectangle-6"></div>
                    <div class="text-wrapper-32">Follow</div>
                  </div>
                </div>
                <div class="remove">
                  <div class="overlap-17"><div class="text-wrapper-33">Remove</div></div>
                </div>
              </div>
              <img class="img-2" src="{% static 'img/homepage modals/pfp 6.png' %}" />
            </div>
          </div>
        </div>
      </div>
    </div>
    <script>
      window.CURRENT_USER = "{{ user.username|escapejs }}";
      window.CSRF_TOKEN = "{{ csrf_token }}";
      window.UPDATE_BIO_URL = "{% url 'update_bio' %}";
    </script>
    <script src="{% static 'js/profile.js' %}"></script>
  </body>
</html>